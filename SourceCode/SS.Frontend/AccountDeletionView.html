<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Space Surfer</title>
    <link rel="icon" href="favicon.ico" />
    <link rel="stylesheet" href="AccountDeletionStyle.css">
    <script src="AccountDeletionFunction.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>

</head>


<body>
    <div class="topbar" id="SSTopBar">
        <t1 class="fix-stroke">Space Surfer</t1>
    </div>

    <div class="center-box" id="DeleteAccountView">
        <h1>Account Deletion</h1>
        <br style="line-height: 30px;">

        <form action="DeletingAccount" method="post" onsubmit="return validateCredentials()">


            <label for="username">Email:</label>
            <input type="email" id="email" name="email" required>
            <br style="line-height: 25px;">

            <label for="OTP">OTP:</label>
            <input type="password" id="OTP" name="OTP" required>
            <input type="checkbox" onclick="showPassword()">Show OTP

            <br style="line-height: 80px;">

            <button type="button" onclick="deleteAccount(document.getElementById('email').value)">Request Deletion</button>
        </form>
    </div>

    <div class="center-box" id="AccountDeletedView" style="display:none;">
        <h1>Account deletion has been requested!</h1>
        <br style="line-height: 30px;">

        <b1>The account will be deleted. Thank you.</b1>

        <br style="line-height: 80px;">

        <button type="submit" onclick="changeView('login')">Return</button>

    </div>

    <script>

    function deleteAccount(email) {

            $.ajax({

                // Our sample url to make request
                url:'http://localhost:8080/api/AccountDeletion/Delete',
                // Type of Request
                type: "POST",
                mode: 'cors',
                cache: 'default',
                credentials: 'same-origin',
                headers: {
                    'Content-Type': 'application/json'
                },
                data: JSON.stringify({ username: email }),

                // Function to call when to
                // request is ok
                success: function (data) {
                    changeView('AccountDeleteView')
                    console.log(data);
                }
            });
        }

    </script>

</body>

</html>
